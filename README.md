# ConfQL

## Example schema

```gql
type Employee {
	name: String!
	email: String!
}

type Team {
	name: String!
	members: [Employee!]!
}

type Department {
	name: String!
	manager: Employee!
	teams: [Team!]!
}

type Query {
	departments: [Department!]!
	devTeams: [Team!]! @confql(path: "departments.engineering.teams")
}

schema {
	query: Query
}
```

## juniper-from-schema

This will create traits like
```
/// Trait for GraphQL field methods generated by `juniper-from-schema`.
pub trait DepartmentFields {
    /// Field method generated by `juniper-from-schema`.
    fn field_name<'a>(
        &self,
        executor: &juniper::Executor<'a, Context>,
    ) -> std::result::Result<&String, juniper::FieldError>;
    /// Field method generated by `juniper-from-schema`.
    fn field_manager<'a>(
        &self,
        executor: &juniper::Executor<'a, Context>,
        trail: &QueryTrail<'a, Employee, juniper_from_schema::Walked>,
    ) -> std::result::Result<&Employee, juniper::FieldError>;
    /// Field method generated by `juniper-from-schema`.
    fn field_teams<'a>(
        &self,
        executor: &juniper::Executor<'a, Context>,
        trail: &QueryTrail<'a, Team, juniper_from_schema::Walked>,
    ) -> std::result::Result<&Vec<Team>, juniper::FieldError>;
}
```
but you'll get plenty of errors like `cannot find type ``Department`` in this scope`.
So it's up to us to:

1. strip @confql directives (maybe PR to juniper-from-schema to just ignore unknown directives)
2. generate the structs ;)
3. maybe just skip juniper-from-schema altogether?


## TODO

Just imagine

```gql
type Employee {
	name: String!
	email: String! @confql(id)
}

type Team {
	name: String!
	members: [Employee!]!
}

type Department {
	name: String! @confql(id)
	manager: Employee!
	teams: [Team!]!
}

type Query {
	# or maybe use jq syntax everywhere?
	employees: [Employee!]! @confql(path: "departments[].teams[].members")
	department($name: String!): Department
	departments: [Department!]!
	# use the id field directive to grab the right department
	devTeams: [Team!]! @confql(path: "departments(engineering).teams[]")
}

schema {
	query: Query
}
```
